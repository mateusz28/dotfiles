#!/bin/bash
PROMPT="Propose 3 different commit messages for this changes. Just list them without any other output."
DELAY=5
function check_step(){
  echo -n "$1  (Y/n)?"; read CONT; [ "$CONT" = "n" ] && exit 0
}
is_in_git_repo() {
  git rev-parse HEAD > /dev/null 2>&1
}
is_in_git_repo || return

MSG=$(tgpt "Don't put any introduction like here are or similar or  other comments apart from requested response. Using conventional commit message prefix. Propose 3 commit message names for $(git diff --cached)" | grep  '.*: ' | fzf)

# Remove any quotes, single quotes, backticks, and leading/trailing whitespace from MSG
MSG=$(echo "$MSG" | tr -d '\"'\''`' | sed 's/^[[:space:]]*//;s/[[:space:]]*$//')

CMD="git commit -m \"$MSG\""
echo "Calling: $CMD"
check_step Continue
eval "$CMD"


